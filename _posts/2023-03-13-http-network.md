---
layout: post
title: "[HTTP] 인터넷 네트워크 - IP, TCP, UDP, Port, DNS"
categories: HTTP
tags: [Web, HTTP, TCP/IP, DNS]
---

## 0. 들어가기에 앞서..

이번 포스트에서는 인터넷 네트워크에 대해 설명하겠습니다.

<br/>
<hr/>

## 1. 인터넷 네트워크

인터넷상에서 다음의 방법으로 PC 및 컴퓨터 간에 통신을 하게 된다.

- 통신 PC가 가까이 있는 경우: 케이블을 이용해 연결함으로써 통신 가능
- 통신 PC가 멀리 있는 경우: 인터넷망을 통해 통신을 하게 되는데, 수많은 중간 노드의 서버를 거쳐 메시지를 주고받을 수 있게 됨


### 1.1 IP (인터넷 프로토콜)

통신을 위해서는 IP 주소를 부여받아야 한다. 
이러한 IP의 역할은 다음과 같다.

- 지정한 IP 주소(IP Address)에 데이터 전달
- 패킷(Packet)이라는 통신 단위로 데이터 전달

> 참고. 
>
> [ 패킷 ]
>
> 패킷은 제어 정보(출발지 IP, 목적지 IP 등)와 사용자 데이터로 구성되어 있다.
>
> [ 패킷의 주요 헤더 정보 ]
> 
> - 버전: 사용 중인 IP의 버전을 식별
> - TTL(Time To Live): 패킷이 네트워크에 남아 있을 수 있는 시간
> - 프로토콜: IP 패킷의 데이터 부분이 전달되는 전송 계층 프로토콜 (ex. TCP, UDP)
> - 출발지(소스) IP: 패킷을 보내는 장치의 IP 주소
> - 목적지(대상) IP: 패킷이 전송되는 IP 주소
>
> 결론적으로 패킷 전달 시, 인터넷망에서 거쳐 지나가는 서버 모두 패킷 내용을 이해하여 목적지 주소로 도달할 수 있도록 전달한다.
>
> <b>참고로 인터넷망을 복잡하기 때문에 요청과 응답에 대한 패킷 이동 경로가 다를 수 있다.</b>

이러한 인터넷 프로토콜은 다음과 같은 이유로 한계점이 존재한다.

1. 비연결성
   - 패킷을 받을 대상이 없거나 서비스 불능 상태여도 대상 서버의 패킷 받을 수 있는 여부를 모르기 때문에 무작정 패킷을 전송함
2. 비신뢰성
   - 패킷 데이터의 용량이 큰 경우에는 패킷을 나누어 보내기 때문에 패킷이 순서대로 전달되지 않거나 중간에 패킷이 사라지는 문제 발생 가능 (패킷마다 다른 경로로 전달될 수 있기 때문)
3. 프로그램 구분 어려움
   - 같은 IP를 사용하는 서버에서 통신하는 애플리케이션이 둘 이상이면 통신에 문제가 발생할 수 있음 

<br/>
<hr/>

### 1.2 TCP와 UDP

IP 주소 만을 사용했을 때 발생하는 위의 문제를 해결하기 위해 TCP를 사용하게 되며, UDP는 문제를 해결하지 않지만 추가적인 특징이 있어 사용된다.

> 참고.
> 
> 인터넷 프로토콜 스택의 4계층은 다음과 같다.
> 
> - 애플리케이션 계층 - HTTP, FTP
> - 전송 계층 - TCP, UDP
> - 인터넷 계층 - IP
> - 네트워크 인터페이스 계층
>
> ![인터넷 프로토콜 스택 4계층](https://user-images.githubusercontent.com/78736070/225296317-6eb6c1d1-e559-4f50-b017-bc4e494a2731.png)
>
> [ 동작 과정 ]
> 
> 1. 프로그램이 메시지를 생성함
> 2. SOCKET 라이브러리를 통해 OS 계층으로 메시지 전달
> 3. 메시지 데이터를 포함한 TCP 정보(단위: 세그먼트) 생성
> 4. TCP 데이터를 포함하여 IP 패킷을 생성
> 5. LAN 카드를 통해 Ethernet Frame이 포함돼서 나감

따라서 IP를 TCP/UDP 층을 통해 보완해 주는 역할을 한다.

> 참고.
> 
> 전송 계층<sup>Transport Layer</sup> : 목적지(수신지)에 신뢰할 수 있는 데이터를 전송하기 위해 필요한 계층으로 TCP와 UDP가 관련됨

<br/>

#### 1.2.1 TCP

**TCP<sup>Transmission Control Protocol</sup>** : 두 개의 호스트를 연결하며 데이터 스트림을 교환하게 해주는 네트워크 프로토콜(전송 제어 프로토콜)

IP 패킷에 TCP 정보가 포함이 되는데, 주요 정보는 다음과 같다. (-> TCP/IP 패킷)

- 출발지(소스) 포트 번호
- 목적지(대상) 포트 번호
- 전송 제어, 순서, 검증 번호 등

**[ TCP 특징 ]**

- 연결 지향적
  - TCP 3-Way Handshake (가상 연결): 연결 후에 메시지를 보내게 됨
- 데이터 전달 보증
  - 데이터가 전송된 이후에 잘 전달되었다면 데이터 전송에 대한 응답을 받음
- 순서 보장
  - 패킷의 전달된 순서가 올바르지 않은 경우에는 목적지에서 옳지 않은 부분부터 다시 전달하라는 요청을 보냄

위와 같은 특징을 갖고 있어 TCP는 신뢰할 수 있는 프로토콜이며, 현재는 대부분 애플리케이션에서 TCP를 사용한다.

<br/>

**[ 3-Way Handshaking ]**

**3-Way Handshaking** : 상호 간의 수신 및 송신 가능 여부(신뢰성 관련)를 알기 위해 데이터 통신 전에 연결하기 위한 사전 작업 (TCP/IP 연결을 위함) (가상 연결)

![3-Way Handshaking](https://user-images.githubusercontent.com/78736070/225300032-a3bcba97-cf7f-4b10-811d-69da1ad8a551.png)

1. 송신 측 컴퓨터(클라이언트)는 수신 측 컴퓨터(서버)에 `SYN` 요청을 보냄( ->SYN )
2. 수신 측에서는 연결 확립을 위한 `ACK`와 송신 측에 전송 허가(연결)를 받기 위한 `SYN`을 함께 보냄 ( <-ACK+SYN )
3. 송신 측에서 수신 측 컴퓨터를 허가한다는 `ACK`를 보냄
4. 연결이 완료되고 통신이 시작됨 (데이터 전송 가능)

이를 통해 송신과 수신 측 모두 `SYN`과 `ACK`를 전달함으로써 신뢰가 생긴다.

cf. 만약 중간에 서버가 끊겨 ACK를 받지 못한 경우에는 연결이 이루어지지 않는다.

<br/>

#### 1.2.2 UDP

**UDP<sup>User Datagram Protocol</sup>** : 사용자 데이터그램 프로토콜로, TCP와 함께 데이터그램으로 알려진 단문 메시지를 교환하기 위해서 사용

**[ UDP 특징 ]**

- 비연결성 통신
  - 데이터가 전송되기 전에 공식적으로 연결이 설정되지 않음
- 데이터 전달을 보증하지 않음
- 순서가 보장되지 않음
- 데이터 전달 및 순서가 보장되지 않지만, 단순하며 전달 속도가 빠름

UDP는 IP와 거의 비슷한데, 대신 데이터그램의 정보로 Port와 Checksum이 추가되는 정도이다.

따라서 UDP는 애플리케이션에서 추가 작업이 필요하다.

<br/>

#### 1.2.3 TCP와 UDP 비교

|프로토콜|특징|
|--|--|
|TCP|연결 지향 통신으로, 신뢰할 수 있으며 데이터를 정확하게 전송 가능|
|UDP|비 연결 통신으로, 신뢰나 정확성보다는 속도와 효율이 높음|

<br/>
<hr/>

### 1.3 Port (포트)

**포트<sup>Port</sup>** : 운영 체제 통신의 종단점을 의미하며, IP 내에서 애플리케이션 상호 구분(프로세스 구분)을 위해 사용하는 번호

하나의 서버 혹은 PC에 한 번에 두 가지 이상을 연결하기 위해 포트를 사용한다.

TCP/IP 패킷의 TCP 세그먼트에 추가적으로 **출발지(소스)의 포트 번호**와 **목적지(대상)의 포트 번호**를 패킷에 담아 전달하게 된다.

이를 통해 같은 IP 내에서 프로세스를 구분하여 통신이 가능하게 된다.

<br/>

**[ Port 특징 ]**

- 네트워크 서비스나 특정 프로세스를 식별하는 논리 단위
- 주로 포트를 사용하는 프로토콜은 전송 계층 프로토콜
- 각 포트는 번호로 구별됨
- 포트 번호는 0부터 65535까지 할당 가능함
- 하지만 <b>0 ~ 1023</b>은 잘 알려진 포트이기 때문에 사용 자제 요망
  - `FTP` : 20, 21
  - `SSH` : 22
  - `TELNET` : 23
  - `DNS` : 53
  - `HTTP` : 80
  - `HTTPS` : 443

> IP와 Port의 차이는?
>
> - IP는 목적지 서버를 구별함
>
> - Port는 서버 안의 애플리케이션을 구별함

<br/>
<hr/>

### 1.4 DNS (Domain Name System)

IP 주소는 기억하기 어려우며 가변적이기 때문에 우리는 도메인 이름을 사용한다.

그렇다면 IP 주소와 도메인 이름을 변환하는 작업이 필요한데, 이 작업을 DNS가 하게 된다.

**DNS<sup>Domain Name System</sup>** : 호스트의 도메인 이름을 호스트의 네트워크 주소로 바꾸거나 그 반대의 변환을 수행

<br/>

**[ DNS 작동 방식 ]**

1. 클라이언트에서 도메인명(ex. www.google.com)을 DNS 서버로 전달
2. DNS 서버에서 도메인명에 따른 IP 주소(ex. 200.200.200.2)를 찾아 응답으로 반환
3. 클라이언트는 응답받은 IP 주소를 이용해 접속하게 됨

<br/>
<hr/>

[ 참고 사이트 ]

- 인프런 강의 중 김영한 님의 "모든 개발자를 위한 HTTP 웹 기본 지식"

<br/>

지금까지 인터넷 네트워크에 대해 설명하였습니다.

감사합니다:)
