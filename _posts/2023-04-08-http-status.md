---
layout: post
title: "[HTTP] HTTP 상태 코드"
categories: HTTP
tags: [Web, HTTP]
---

## 0. 들어가기에 앞서..

이번 포스트에서는 HTTP 상태 코드에 대해 설명하겠습니다.

<br/>
<hr/>

## HTTP 상태 코드

**HTTP 상태 코드**: 클라이언트가 보낸 요청의 처리 상태를 응답에서 알려주는 기능

모든 HTTP 응답 코드는 5개의 클래스(분류)로 구분된다.

- **1xx (Informational)**: 요청이 수신되어 처리 중
- **2xx (Successful)**: 요청을 성공적으로 <mark>정상 처리</mark>
- **3xx (Redirection)**: 요청 완료를 위해 <mark>추가 작업 조치</mark>가 필요함
- **4xx (Client Error)**: <mark>클라이언트 오류</mark>, 잘못된 문법 등으로 서버가 요청을 수행할 수 없음
- **5xx (Server Error)**: <mark>서버 오류</mark>, 서버가 정상 요청을 처리하지 못함

따라서 클라이언트는 응답 상태 코드를 확인하여 처리하면 된다.

> 만약 클라이언트가 인식할 수 없는 상태 코드를 서버가 반환하는 경우에는?
>
> 클라이언트는 상위 상태 코드로 해석해서 처리하면 된다.
>
> ex. 420을 반환하면 4xx로 생각하여 클라이언트 오류라고 해석하면 된다.

<br/>

### 1. 정보 응답 - 1xx (Informational)

요청을 받았으며 작업을 계속한다.

- 100 (Continue): 지금까지 상태가 괜찮으며 클라이언트가 계속해서 요청을 하거나 이미 요청을 완료한 경우에는 무시해도 됨

1xx 상태 코드는 잘 사용하지 않는다.

<br/>
<hr/>

### 2. 성공 응답 - 2xx (Successful)

클라이언트의 요청을 성공적으로 처리했음을 의미한다.

예시로 아래의 4개의 상태 코드를 살펴보자.

- 200 OK
- 201 Created
- 202 Accepted
- 204 No Content

#### 200 OK

서버가 요청을 제대로 처리했음을 의미한다.

<img src="https://user-images.githubusercontent.com/78736070/230719688-a0b3cfab-60d3-4b40-ae54-c6c246d4c7be.png" width=200 placeholder="HTTP 상태 코드 - 200" />

<br/>

#### 201 Created

서버에 성공적으로 요청되었으며, 서버가 새 리소스를 생성하였음을 의미한다.

<img src="https://user-images.githubusercontent.com/78736070/230719479-efe0be9a-44b5-4ae9-9ff0-71e654740783.png" width=200 placeholder="HTTP 상태 코드 - 201" />

이때, <u>생성된 리소스는 응답의 Location 헤더 필드로 식별됨</u>

<br/>

#### 202 Accepted

서버가 요청을 접수했지만, 아직 처리하지 않았음을 의미한다.

보통 요청을 받고 한 번에 처리하는 "배치 처리"에서 사용된다.

<br/>

#### 204 No Content

서버가 요청을 성공적으로 수행했지만, 응답 페이로드 본문에 보낼 데이터가 없을 때 반환된다.

예를 들어, 문서를 편집 시 "저장" 버튼을 눌렀을 때 결과로 아무 내용이 필요 없기 때문에 사용된다.

응답 본문 내용이 없어도 204 메시지(2xx) 만으로 성공을 인식하면 된다.

<br/>
<hr/>

### 3. 리다이렉션 - 3xx (Redirection)

클라이언트는 요청을 완료하기 위해 추가 조치를 취해야 한다.

웹 브라우저는 3xx 응답의 결과에 Location 헤더가 있으면, Location 위치로 자동으로 이동한다. (리다이렉트)

> **리다이렉션 종류**

- **영구 리다이렉션**: 특정 리소스의 URI가 영구적으로 이동됨
  - ex) /members -> /users
  - ex) /event -> /new-event
- **일시 리다이렉션**: 일시적인 변경
  - ex) 주문 완료 이후 주문 내역 화면으로 이동
  - <mark>PRG: Post/Redirect/Get</mark>
- **특수 리다이렉션**
  - 결과 대신 캐시 사용


리다이렉션의 예시로 아래의 7개의 상태 코드를 살펴보자.

- 300 Multiple Choices
- 301 Moved Permanently
- 302 Found
- 303 See Other
- 304 Not Modified
- 307 Temporary Redirect
- 308 Permanent Redirect

#### 300 Multiple Choices

요청에 대해서 하나 이상의 응답이 가능하다.

클라이언트는 그중에 하나를 반드시 선택해야 한다.

<br/>

#### 영구 리다이렉션 - 301, 308

기존 URL을 사용하지 않고, 리소스의 URI가 영구적으로 이동된다.

**301 Moved Permanently**

- 리다이렉트 시, <u>요청 메서드가 GET</u>으로 변하고, <u>본문이 제거</u>될 수 있음

<img src="https://user-images.githubusercontent.com/78736070/230720781-e60126b4-f769-43d7-a543-114539f7224f.png" height=250 placeholder="HTTP 상태 코드 - 301" />

> 위의 예시에서 요청 메서드가 GET으로 변경되며, 본문 메시지가 사라짐!

<br/>

**308 Permanent Redirect**

- 301과 기능은 동일함
- 리다이렉트 시, 요청 메서드와 본문이 유지됨 *(301과 차이점)*

<br/>
  
#### 일시적 리다이렉션 - 302, 307, 303

리소스의 URI가 일시적으로 변경된다.

> 307, 303을 권장하지만, 이미 많은 애플리케이션 라이브러리들이 302를 기본값으로 사용함

**302 Found**

- 리다이렉트 시, <u>요청 메서드가 GET</u>으로 변하고, <u>본문이 제거</u>될 수 있음
- 클라이언트는 향후의 요청도 반드시 동일한 URI로 해야 함
- 실무에서 가장 많이 사용함

<br/>

**307 Temporary Redirect**

- 302와 기능은 같음
- 리다이렉트 시, 요청 메서드와 본문이 유지됨 *(302와 차이점)*

<br/>

**303 See Other**

- 302과 기능은 동일함
- 리다이렉트 시, <u>요청 메서드가 GET</u>으로 변경 *(302와 차이점)*

<br/>

**[ PRG (Post/Redirect/GET) ]**

- 배경

   POST로 주문 후, 웹 브라우저를 새로고침할 경우에는 어떻게 될까?

   -> 중복 주문이 될 수도 있다!

- PRG 소개
  
  <u>POST</u>로 주문 후에 주문 결과 화면을 <u>GET 메서드</u>로 <u>리다이렉트</u>하면 중복 주문을 방지할 수 있다!

  -> 새로고침을 해도 결과 화면을 GET으로 조회한다:)

  <img src="https://user-images.githubusercontent.com/78736070/230721638-7814e737-c58e-4587-bb89-fc8e21ef9c6e.png" height=250 placeholder="HTTP 상태 코드 - 302" />

   > 리다이렉트 후, 요청 메서드가 GET으로 변경되며, 본문 메시지가 사라짐

<br/>

#### 특수 리다이렉션 - 304

**304 Not Modified**

- 캐시를 목적으로 사용함
- 서버에서 클라이언트로 캐시를 사용해도 된다고 말해주는 것
- 클라이언트에게 리소스가 수정되지 않았음을 알려주기 때문에, 이후 클라이언트는 로컬 PC에 저장된 캐시를 재사용할 수 있음 (캐시로 리다이렉트함)
- 304는 응답에 메시지 바디를 포함하면 안 됨
- 조건부 GET, HEAD 요청 시에 사용함

<br/>
<hr/>

### 4. 클라이언트 오류 - 4xx (Client Error)
   
클라이언트의 요청에 잘못된 문법 등으로 서버가 요청을 수행할 수 없음을 말한다.

즉, <u>오류의 원인은 클라이언트라는 것이다!</u>

<mark>따라서 클라이언트가 잘못된 요청 및 데이터를 보내고 있기 때문에, 똑같이 재시도를 하더라도 실패한다.</mark>

예시로 아래의 4개의 상태 코드를 살펴보자.

- 400 Bad Request
- 401 Unauthorized
- 403 Forbidden
- 404 Not Found

#### 400 Bad Request

클라이언트가 잘못된 요청을 해서 서버가 요청을 처리할 수 없다.

포괄적 의미로 400을 보통 사용하면 된다.

- 요청 구문, 메시지, 문법 등등 오류
- 클라이언트는 요청 내용을 다시 검토하고 보내야 함
- ex) 요청 파라미터 잘못, API 스펙이 맞지 않을 때

<br/>

#### 401 Unauthorized

클라이언트가 해당 리소스에 대한 인증(Authentication)이 필요하다는 뜻이다.

보통 로그인 입력 정보가 잘못됐을 경우 401을 반환한다.

401 오류 발생 시에는 응답에 WWW-Authenticate 헤더와 함께 인증 방법을 설명한다.

> 인증? 인가?
> 
> 인증<sup>Authentication</sup>: 본인이 누구인지 확인 (로그인)
> 
> 인가<sup>Authorization</sup>: 권한 부여 (ADMIN 권한처럼 특정 리소스에 접근할 수 있는 권한, 인증이 있어야 인가가 존재함)

<br/>

#### 403 Forbidden

서버가 요청을 이해했지만 승인을 거부했다는 뜻이다.

주로 인증 자격 증명<sub>(ex. 로그인)</sub>은 있지만, 접근 권한이 불충분한 경우이다.

- ex) ADMIN이 아닌 사용자가 로그인했지만, ADMIN 만 접근 가능한 리소스에 접근하는 경우

<br/>

#### 404 Not Found

요청 리소스를 찾을 수 없음을 의미한다.

보통 요청 리소스가 서버에 없는 경우이며, 혹은 클라이언트가 권한이 부족한 리소스에 접근할 시 해당 리소스를 숨기고 싶을 때 반환한다.

<br/>
<hr/>

### 5. 서버 오류 - 5xx (Server Error)

서버 문제로 오류 발생하는 경우를 말한다.

즉, <u>오류의 원인은 서버라는 것이다!</u>

<mark>서버에 문제가 있기 때문에 재시도 하면 성공할 수도 있다.</mark> (서버에서 복구하는 경우 등)

예시로 아래의 2개의 상태 코드를 살펴보자.

- 500 Internal Server Error
- 503 Service Unavailable

#### 500 Internal Server Error

서버 내부 문제로 오류 발생하는 경우이며, 보통 대부분 서버 오류는 500을 반환한다.

<br/>

#### 503 Service Unavailable

서비스를 이용할 수 없음을 의미한다.

서버가 일시적인 과부하 또는 예정된 작업으로 잠시 요청을 처리할 수 없는 경우이다.

(참고) Retry-After 헤더 필드로 얼마 후에 복구되는지 보낼 수도 있다.


> 5xx 오류는 거의 발생하는 경우가 없어야 한다.
> 
> -> 500 오류는 정말 심각한 서버 문제라는 것이다.

<br/>
<hr/>

[ 참고 사이트 ]

- 인프런 강의 중 김영한 님의 "모든 개발자를 위한 HTTP 웹 기본 지식"
- [HTTP 상태 코드 자료](https://developer.mozilla.org/ko/docs/Web/HTTP/Status)

<br/>

지금까지 HTTP 상태 코드에 대해 설명하였습니다.

감사합니다:)
